trigger:
  branches:
    include:
      - main

pool:
  name: Default

steps:
- script: |
    echo "=== INICIANDO PIPELINE ==="
    python3 --version
    pwd
    ls -la
  displayName: 'Verificar entorno'

- script: |
    python3 -m pip install --upgrade pip
    python3 -m pip install -r requirements.txt
    python3 -m pip install pytest pytest-cov
  displayName: 'Instalar dependencias'

- script: |
    python3 -m unittest test_core_bancario -v
  displayName: 'Ejecutar pruebas unitarias'

- script: |
    python3 -m pytest test_core_bancario.py -v
  displayName: 'Ejecutar con pytest'

- script: |
    python3 -m pytest --cov=core_bancario --cov-report=term
  displayName: 'Calcular cobertura'